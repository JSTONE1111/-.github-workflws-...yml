#!/usr/bin/env node
/**
 * Secrets Manager - Load and validate environment variables
 * Usage: require('./secrets-manager') at the top of your app
 */

require('dotenv').config();

const requiredSecrets = {
  // GitHub
  GITHUB_TOKEN: 'GitHub Personal Access Token',
  
  // Cloud Providers
  GCP_PROJECT_ID: 'Google Cloud Project ID',
  AWS_ACCESS_KEY_ID: 'AWS Access Key',
  AWS_SECRET_ACCESS_KEY: 'AWS Secret Key',
  
  // Blockchain
  PRIVATE_KEY: 'Ethereum Private Key',
  INFURA_PROJECT_ID: 'Infura Project ID',
  
  // APIs
  OPENAI_API_KEY: 'OpenAI API Key',
  
  // Add more as needed...
};

const optionalSecrets = {
  DISCORD_WEBHOOK_URL: 'Discord Webhook',
  SLACK_BOT_TOKEN: 'Slack Bot Token',
  TELEGRAM_BOT_TOKEN: 'Telegram Bot Token',
  // Add optional ones here...
};

class SecretsManager {
  constructor() {
    this.secrets = {};
    this.missing = [];
    this.warnings = [];
  }

  load() {
    console.log('ðŸ” Loading secrets...\n');

    // Check required secrets
    Object.entries(requiredSecrets).forEach(([key, description]) => {
      if (process.env[key]) {
        this.secrets[key] = process.env[key];
        console.log(`âœ“ ${key}: ${description}`);
      } else {
        this.missing.push({ key, description });
        console.error(`âœ— ${key}: MISSING - ${description}`);
      }
    });

    // Check optional secrets
    Object.entries(optionalSecrets).forEach(([key, description]) => {
      if (process.env[key]) {
        this.secrets[key] = process.env[key];
        console.log(`âœ“ ${key}: ${description}`);
      } else {
        this.warnings.push({ key, description });
        console.warn(`âš  ${key}: Optional - ${description}`);
      }
    });

    console.log('\n');

    // Error if required secrets are missing
    if (this.missing.length > 0) {
      console.error('âŒ Missing required secrets:');
      this.missing.forEach(({ key, description }) => {
        console.error(`   - ${key}: ${description}`);
      });
      console.error('\nPlease add them to your .env file');
      process.exit(1);
    }

    console.log('âœ… All required secrets loaded!\n');
    
    return this.secrets;
  }

  get(key) {
    if (!this.secrets[key]) {
      throw new Error(`Secret ${key} not found`);
    }
    return this.secrets[key];
  }

  has(key) {
    return !!this.secrets[key];
  }

  // Validate specific formats
  validateEthereumPrivateKey(key
